<script>
  import { createEventDispatcher } from 'svelte';
  const dispatch = createEventDispatcher();

import jsPDF from 'jspdf';
import {font} from './font';

export let invoice;

let {title, id} = invoice;


let doc = new jsPDF();

doc.addFileToVFS('OpenSans-Regular-normal.ttf', font);
doc.addFont('OpenSans-Regular-normal.ttf', 'OpenSans-Regular', 'normal');
doc.setFont('OpenSans-Regular', 'normal');


let name = 'Консалт';
//let img = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAH0CAYAAADL1t+KAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkIzQTA5NzlBRUI0MTFFOUEyMTBDQzEzNUVDOTUzNEUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkIzQTA5N0FBRUI0MTFFOUEyMTBDQzEzNUVDOTUzNEUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCQjNBMDk3N0FFQjQxMUU5QTIxMENDMTM1RUM5NTM0RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCQjNBMDk3OEFFQjQxMUU5QTIxMENDMTM1RUM5NTM0RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoKt43kAABYoSURBVHja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';

let now = new Date();
let date = now.getTime().toString();

let fontSize = 18;
let offsetY = 5;
let lineHeight = 8;
  
doc.setFontSize(fontSize);
//doc.addImage(img, 150, 10, 30, 30)
doc.text(10, 10 + lineHeight * 0 + offsetY, `Для: ${name}`)
doc.text(10, 10 + lineHeight * 1 + offsetY, `От: ${date}`)
doc.text(10, 10 + lineHeight * 2 + offsetY, `Оплатить до: `)
doc.text(10, 10 + lineHeight * 5 + offsetY, `Счёт № ${id}`)
doc.text(10, 10 + lineHeight * 6 + offsetY, `Наименование работ: ${title}`)

doc.setFontSize(13);
doc.text(10, 10 + lineHeight * 33 + offsetY, `Благодарю за сотрудничество.`)


function createPdf(){
  doc.save(`inv_${name}_${date}.pdf`);
  dispatch('lock');
}

</script>

<button class="btn btn-link" on:click={createPdf}>send</button>